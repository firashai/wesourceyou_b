-- Complete Database Setup for WeSourceYou
-- This script will reset the database and populate it with dummy data

-- Step 1: Drop existing tables in correct order (due to foreign key constraints)
DROP TABLE IF EXISTS `job_applications`;
DROP TABLE IF EXISTS `media_purchases`;
DROP TABLE IF EXISTS `jobs`;
DROP TABLE IF EXISTS `media_content`;
DROP TABLE IF EXISTS `journalists`;
DROP TABLE IF EXISTS `companies`;
DROP TABLE IF EXISTS `users`;
DROP TABLE IF EXISTS `typeorm_metadata`;

-- Step 2: Create tables with the new optimized schema
-- Note: Tables will be created by TypeORM when synchronize is enabled

-- Step 3: Insert dummy data for all tables

-- Users
INSERT INTO `users` (`id`, `email`, `password`, `firstName`, `lastName`, `role`, `status`, `phoneNumber`, `country`, `city`, `profilePicture`, `emailVerified`, `createdAt`, `updatedAt`) VALUES
(1, 'john.doe@example.com', '$2b$10$UqU5SSLefxUWRflJPmlKbu8W6vba8GvFixRWZn76j2ODe6tW/d0f6', 'John', 'Doe', 'journalist', 'active', '+1234567890', 'United States', 'New York', 'https://example.com/profiles/john.jpg', true, NOW(), NOW()),
(2, 'jane.smith@example.com', '$2b$10$UqU5SSLefxUWRflJPmlKbu8W6vba8GvFixRWZn76j2ODe6tW/d0f6', 'Jane', 'Smith', 'company', 'active', '+1234567891', 'United States', 'Los Angeles', 'https://example.com/profiles/jane.jpg', true, NOW(), NOW()),
(3, 'ahmed.hassan@example.com', '$2b$10$UqU5SSLefxUWRflJPmlKbu8W6vba8GvFixRWZn76j2ODe6tW/d0f6', 'Ahmed', 'Hassan', 'journalist', 'active', '+20123456789', 'Egypt', 'Cairo', 'https://example.com/profiles/ahmed.jpg', true, NOW(), NOW()),
(4, 'maria.garcia@example.com', '$2b$10$UqU5SSLefxUWRflJPmlKbu8W6vba8GvFixRWZn76j2ODe6tW/d0f6', 'Maria', 'Garcia', 'company', 'active', '+34612345678', 'Spain', 'Madrid', 'https://example.com/profiles/maria.jpg', true, NOW(), NOW()),
(5, 'admin@wesourceyou.com', '$2b$10$UqU5SSLefxUWRflJPmlKbu8W6vba8GvFixRWZn76j2ODe6tW/d0f6', 'Admin', 'User', 'admin', 'active', '+1234567899', 'United States', 'San Francisco', 'https://example.com/profiles/admin.jpg', true, NOW(), NOW());

-- Journalists
INSERT INTO `journalists` (`id`, `userId`, `bio`, `mediaWorkType`, `analystSpecialty`, `cameraType`, `audioEquipmentType`, `socialMediaAccounts`, `previousWorkLinks`, `skills`, `languages`, `certifications`, `portfolio`, `hourlyRate`, `dailyRate`, `projectRate`, `completedProjects`, `rating`, `createdAt`, `updatedAt`) VALUES
(1, 1, 'Experienced journalist with 10+ years covering Middle Eastern affairs. Specialized in conflict reporting and political analysis.', 'video_production', 'middle_eastern_affairs', 'Sony FX6', 'Sennheiser MKH416', '{"twitter": "@johndoe_news", "linkedin": "john-doe-journalist", "instagram": "@johndoe_media"}', '["https://example.com/work1", "https://example.com/work2"]', '["Video Editing", "Conflict Reporting", "Political Analysis", "Arabic Translation"]', '["English", "Arabic", "French"]', '["War Correspondent Certification", "First Aid Training"]', '["https://example.com/portfolio1", "https://example.com/portfolio2"]', 75.00, 600.00, 2500.00, 45, 4.8, NOW(), NOW()),
(2, 3, 'Award-winning journalist specializing in Arabic affairs and cultural reporting. Fluent in multiple Arabic dialects.', 'photo_journalism', 'arabic_affairs', 'Canon EOS R5', 'Rode NTG5', '{"twitter": "@ahmed_hassan_news", "linkedin": "ahmed-hassan-journalist"}', '["https://example.com/ahmed-work1", "https://example.com/ahmed-work2"]', '["Photojournalism", "Cultural Reporting", "Arabic Translation", "Video Production"]', '["Arabic", "English", "French"]', '["Photojournalism Award", "Cultural Reporting Certification"]', '["https://example.com/ahmed-portfolio1", "https://example.com/ahmed-portfolio2"]', 65.00, 500.00, 2000.00, 32, 4.9, NOW(), NOW());

-- Companies
INSERT INTO `companies` (`id`, `userId`, `name`, `website`, `description`, `mission`, `vision`, `logo`, `requiredServices`, `companySize`, `industry`, `specializations`, `languages`, `locations`, `socialMediaAccounts`, `contactPersons`, `paymentMethods`, `preferredCommunication`, `createdAt`, `updatedAt`) VALUES
(1, 2, 'Global Media Network', 'https://globalmedianetwork.com', 'Leading international media company specializing in news coverage and documentary production.', 'To provide accurate, unbiased news coverage to global audiences.', 'To be the most trusted source of international news and media content.', 'https://example.com/logos/global-media.png', '[{"service": "video_production", "priority": "high"}, {"service": "photo_journalism", "priority": "medium"}]', '{"employees": 500, "type": "large"}', '["Media", "News", "Entertainment"]', '["News Coverage", "Documentary Production", "Live Broadcasting"]', '["English", "Spanish", "Arabic"]', '[{"country": "United States", "city": "Los Angeles"}, {"country": "Spain", "city": "Madrid"}]', '{"twitter": "@globalmedianetwork", "linkedin": "global-media-network", "facebook": "globalmedianetwork"}', '[{"name": "Jane Smith", "position": "Media Director", "email": "jane.smith@globalmedianetwork.com", "phone": "+1234567891"}]', '["bank_transfer", "paypal", "credit_card"]', '["email", "phone", "video_call"]', NOW(), NOW()),
(2, 4, 'European News Agency', 'https://europeannewsagency.eu', 'Premier European news agency covering political, economic, and cultural stories across the continent.', 'To deliver comprehensive European news coverage with local expertise.', 'To be the leading source of European news and analysis.', 'https://example.com/logos/european-news.png', '[{"service": "photo_journalism", "priority": "high"}, {"service": "video_production", "priority": "medium"}]', '{"employees": 250, "type": "medium"}', '["Media", "News", "Politics"]', '["Political Reporting", "Economic Analysis", "Cultural Coverage"]', '["English", "Spanish", "French", "German"]', '[{"country": "Spain", "city": "Madrid"}, {"country": "France", "city": "Paris"}]', '{"twitter": "@europeannews", "linkedin": "european-news-agency"}', '[{"name": "Maria Garcia", "position": "Editor-in-Chief", "email": "maria.garcia@europeannewsagency.eu", "phone": "+34612345678"}]', '["bank_transfer", "paypal"]', '["email", "video_call"]', NOW(), NOW());

-- Jobs
INSERT INTO `jobs` (`id`, `companyId`, `title`, `description`, `jobType`, `mediaWorkType`, `analystSpecialty`, `experienceLevel`, `requiredSkills`, `preferredSkills`, `requiredLanguages`, `preferredLanguages`, `locations`, `salary`, `benefits`, `requirements`, `projectDetails`, `startDate`, `endDate`, `applicationDeadline`, `numberOfPositions`, `isUrgent`, `status`, `tags`, `categories`, `additionalInfo`, `contactInfo`, `applicationQuestions`, `applicationsCount`, `viewsCount`, `createdAt`, `updatedAt`) VALUES
(1, 1, 'Middle East Conflict Correspondent', 'Seeking experienced journalist to cover ongoing conflicts in the Middle East region. Must have conflict reporting experience and Arabic language skills.', 'freelance', 'video_production', 'middle_eastern_affairs', 'senior', '["Conflict Reporting", "Arabic Translation", "Video Production", "Live Broadcasting"]', '["Safety Training", "Satellite Communication", "First Aid"]', '["Arabic", "English"]', '["French", "Turkish"]', '[{"country": "Syria", "city": "Aleppo", "isRemote": false, "travelRequired": true}, {"country": "Iraq", "city": "Baghdad", "isRemote": false, "travelRequired": true}, {"country": "Yemen", "city": "Sanaa", "isRemote": false, "travelRequired": true}]', '{"min": 5000, "max": 8000, "currency": "USD", "period": "monthly", "isNegotiable": true}', '["Health Insurance", "Travel Allowance", "Equipment Provided", "Hazard Pay"]', '{"hasCamera": true, "cameraType": "Professional camera", "hasAudioEquipment": true, "audioEquipmentType": "Professional audio gear", "canTravel": true, "certifications": ["First Aid", "Conflict Zone Safety"], "portfolio": true}', 'Cover ongoing conflicts in Syria, Yemen, and Iraq. Produce daily video reports and live broadcasts. Work closely with local sources and maintain safety protocols.', '2024-01-15', '2024-12-31', '2024-01-10', 1, true, 'published', '["conflict", "middle_east", "video", "urgent"]', '["news", "conflict_reporting", "international"]', 'This is a high-risk assignment requiring extensive safety training and conflict zone experience.', '{"email": "jobs@globalmedianetwork.com", "phone": "+1234567890", "contact_person": "Jane Smith"}', '["Describe your conflict reporting experience", "How do you ensure safety in conflict zones?", "What is your approach to building local sources?"]', 0, 0, NOW(), NOW()),
(2, 2, 'European Political Analyst', 'Looking for experienced political analyst to cover European Union politics and policy developments. Must have deep understanding of EU institutions.', 'contract', 'photo_journalism', 'european_affairs', 'mid_level', '["Political Analysis", "EU Policy", "Photojournalism", "Multilingual Communication"]', '["Policy Research", "Data Analysis", "Interview Skills"]', '["English", "French", "German"]', '["Spanish", "Italian"]', '[{"country": "Belgium", "city": "Brussels", "isRemote": false, "travelRequired": true}, {"country": "France", "city": "Paris", "isRemote": false, "travelRequired": true}, {"country": "Germany", "city": "Berlin", "isRemote": false, "travelRequired": true}]', '{"min": 4000, "max": 6000, "currency": "EUR", "period": "monthly", "isNegotiable": true}', '["Health Insurance", "Relocation Assistance", "Professional Development"]', '{"hasCamera": true, "cameraType": "Professional camera", "hasAudioEquipment": true, "audioEquipmentType": "Professional audio gear", "canTravel": true, "certifications": ["EU Policy Analysis"], "portfolio": true}', 'Cover EU political developments, policy changes, and institutional news. Produce photo essays and analytical pieces for European audiences.', '2024-02-01', '2024-08-31', '2024-01-25', 1, false, 'published', '["politics", "europe", "analysis", "eu"]', '["news", "politics", "analysis"]', 'Position requires regular travel to Brussels and other EU capitals.', '{"email": "careers@europeannewsagency.eu", "phone": "+34612345678", "contact_person": "Maria Garcia"}', '["What is your understanding of EU institutions?", "How do you approach political analysis?", "Describe your experience with European politics"]', 0, 0, NOW(), NOW());

-- Media Content
INSERT INTO `media_content` (`id`, `journalistId`, `title`, `description`, `mediaType`, `fileUrl`, `thumbnailUrl`, `previewUrl`, `tags`, `categories`, `location`, `recordedDate`, `duration`, `resolution`, `fileSize`, `metadata`, `usageRights`, `reviews`, `watermarks`, `alternativeFormats`, `status`, `price`, `createdAt`, `updatedAt`) VALUES
(1, 1, 'Syria Conflict Report - January 2024', 'Comprehensive video report covering the latest developments in the Syrian conflict, including interviews with local residents and analysis from experts.', 'video', 'https://example.com/media/syria-conflict-jan2024.mp4', 'https://example.com/thumbnails/syria-conflict-thumb.jpg', 'https://example.com/previews/syria-conflict-preview.mp4', '["conflict", "syria", "war", "refugees", "humanitarian"]', '["news", "conflict_reporting", "international"]', 'Syria', '2024-01-15', '00:15:30', '1920x1080', '2.5GB', '{"camera": "Sony FX6", "audio": "Sennheiser MKH416", "location": "Aleppo, Syria", "interviews": 5, "expert_analysis": true}', '{"license_type": "exclusive", "usage_restrictions": "news_media_only", "duration": "unlimited", "territory": "global"}', '{"rating": 4.8, "comments": ["Excellent coverage", "Professional quality", "Comprehensive analysis"]}', '["Global Media Network", "News Agency"]', '["MP4", "MOV", "WebM"]', 'published', 500.00, NOW(), NOW()),
(2, 2, 'Cairo Cultural Festival Photo Essay', 'Photo essay documenting the vibrant cultural festival in Cairo, showcasing local artists, musicians, and traditional celebrations.', 'photo', 'https://example.com/media/cairo-festival-photos.zip', 'https://example.com/thumbnails/cairo-festival-thumb.jpg', 'https://example.com/previews/cairo-festival-preview.pdf', '["culture", "cairo", "festival", "art", "music", "tradition"]', '["culture", "photojournalism", "local"]', 'Cairo, Egypt', '2024-01-10', '00:00:00', '4000x3000', '150MB', '{"camera": "Canon EOS R5", "photos": 45, "location": "Various venues in Cairo", "artists": 12}', '{"license_type": "non_exclusive", "usage_restrictions": "cultural_media", "duration": "2_years", "territory": "global"}', '{"rating": 4.9, "comments": ["Beautiful photography", "Captures local culture perfectly", "High artistic value"]}', '["European News Agency"]', '["JPG", "RAW", "PDF"]', 'published', 300.00, NOW(), NOW());

-- Media Purchases
INSERT INTO `media_purchases` (`id`, `transactionId`, `amount`, `platformFee`, `sellerAmount`, `status`, `paymentMethod`, `paymentReference`, `licenseDetails`, `buyerInfo`, `notes`, `downloadUrl`, `downloadExpiryDate`, `isDownloaded`, `downloadedAt`, `refundReason`, `createdAt`, `updatedAt`) VALUES
(1, 'TXN123456789', 500.00, 50.00, 450.00, 'completed', 'bank_transfer', 'TXN123456789', '{"type": "exclusive", "usage": ["news_media", "documentary"], "restrictions": ["no_commercial_use"], "expirationDate": "2024-12-31"}', '{"name": "Global Media Network", "email": "purchases@globalmedianetwork.com", "company": "Global Media Network", "usage": "News coverage"}', 'Excellent quality content for our Middle East coverage.', 'https://example.com/downloads/syria-conflict-jan2024.mp4', '2024-12-31', true, '2024-01-20', NULL, NOW(), NOW()),
(2, 'TXN987654321', 300.00, 30.00, 270.00, 'completed', 'paypal', 'TXN987654321', '{"type": "non_exclusive", "usage": ["cultural_media", "educational"], "restrictions": ["attribution_required"], "expirationDate": "2026-01-18"}', '{"name": "European News Agency", "email": "content@europeannewsagency.eu", "company": "European News Agency", "usage": "Cultural feature"}', 'Perfect for our cultural coverage section.', 'https://example.com/downloads/cairo-festival-photos.zip', '2024-12-31', true, '2024-01-18', NULL, NOW(), NOW());

-- Job Applications
INSERT INTO `job_applications` (`id`, `jobId`, `journalistId`, `companyId`, `coverLetter`, `resumeUrl`, `resumeFilename`, `resumeSize`, `portfolio`, `samples`, `status`, `proposedRate`, `proposedRateCurrency`, `proposedRatePeriod`, `availableStartDate`, `availability`, `answers`, `references`, `additionalInfo`, `skills`, `languages`, `equipment`, `experience`, `education`, `notes`, `rejectionReason`, `rejectedAt`, `rejectedBy`, `acceptanceNotes`, `acceptedAt`, `acceptedBy`, `createdAt`, `updatedAt`) VALUES
(1, 1, 1, 1, 'I am excited to apply for the Middle East Conflict Correspondent position. With over 10 years of experience covering conflicts in the region, I bring deep expertise in Arabic language, cultural understanding, and extensive safety training. My previous work includes coverage of the Syrian civil war, Yemen conflict, and Iraqi reconstruction efforts. I am available immediately and can provide references from major news organizations.', 'https://example.com/resumes/john-doe-resume.pdf', 'john-doe-resume.pdf', 2048576, 'https://example.com/portfolios/john-doe-portfolio.pdf', 'https://example.com/samples/john-doe-samples.zip', 'pending', 6000.00, 'USD', 'monthly', '2024-01-15', '{"days": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"], "hours": "9:00 AM - 6:00 PM", "timezone": "GMT+3"}', '[{"question": "Describe your conflict reporting experience", "answer": "I have covered conflicts in Syria, Yemen, and Iraq for over 10 years, including embedded reporting with various factions and humanitarian organizations."}, {"question": "How do you ensure safety in conflict zones?", "answer": "I follow strict safety protocols, maintain communication with editors, use protective gear, and build relationships with local contacts for security updates."}]', '[{"name": "Sarah Johnson", "position": "News Director", "company": "CNN", "email": "sarah.johnson@cnn.com", "phone": "+1234567890"}]', 'I am certified in first aid, conflict zone safety, and have extensive experience working with local translators and fixers.', '["Conflict Reporting", "Arabic Translation", "Video Production", "Live Broadcasting", "Safety Training"]', '["Arabic (Native)", "English (Fluent)", "French (Conversational)"]', '["Sony FX6 Camera", "Sennheiser MKH416 Microphone", "Satellite Phone", "Protective Gear"]', '10+ years covering Middle East conflicts, embedded reporting experience, multiple awards for conflict coverage', 'Bachelor of Journalism, Columbia University; Master of International Relations, Georgetown University', 'Available for immediate deployment and can provide additional safety certifications.', NULL, NULL, NULL, NULL, NULL, NULL, NOW(), NOW()),
(2, 2, 2, 2, 'I am applying for the European Political Analyst position with strong background in EU politics and policy analysis. My experience includes covering EU institutions in Brussels, analyzing policy developments, and producing comprehensive reports for European audiences. I am fluent in multiple European languages and have deep understanding of EU governance structures.', 'https://example.com/resumes/ahmed-hassan-resume.pdf', 'ahmed-hassan-resume.pdf', 1536000, 'https://example.com/portfolios/ahmed-hassan-portfolio.pdf', 'https://example.com/samples/ahmed-hassan-samples.zip', 'shortlisted', 5000.00, 'EUR', 'monthly', '2024-02-01', '{"days": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"], "hours": "8:00 AM - 5:00 PM", "timezone": "GMT+1"}', '[{"question": "What is your understanding of EU institutions?", "answer": "I have covered EU institutions for 5 years, including the European Parliament, Commission, and Council. I understand the legislative process, policy-making procedures, and inter-institutional dynamics."}, {"question": "How do you approach political analysis?", "answer": "I combine policy analysis with on-the-ground reporting, interview key stakeholders, and provide context for complex political developments."}]', '[{"name": "Pierre Dubois", "position": "Editor", "company": "Le Monde", "email": "pierre.dubois@lemonde.fr", "phone": "+33123456789"}]', 'I have extensive contacts within EU institutions and can provide insider perspectives on policy developments.', '["Political Analysis", "EU Policy", "Photojournalism", "Multilingual Communication", "Policy Research"]', '["English (Fluent)", "French (Fluent)", "German (Conversational)", "Arabic (Native)"]', '["Canon EOS R5 Camera", "Professional Audio Equipment", "Mobile Studio Setup"]', '5+ years covering EU politics, policy analysis experience, multiple language skills', 'Master of European Studies, Sciences Po Paris; Bachelor of Political Science, Cairo University', 'Can provide additional EU policy analysis samples and references from EU officials.', NULL, NULL, NULL, 'Strong candidate with excellent EU knowledge and language skills.', '2024-01-25', 2, NOW(), NOW());

-- Update job applications count
UPDATE `jobs` SET `applicationsCount` = 1 WHERE `id` = 1;
UPDATE `jobs` SET `applicationsCount` = 1 WHERE `id` = 2;

-- Success message
SELECT 'Database setup completed successfully!' as status;
